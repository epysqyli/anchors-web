import{F as L,f as x,a as F}from"./feed-6c35ba5d.js";import{u as R,R as V,b as e,e as U,o as X,d as B,f as H,c as v,L as b,S as j,h as k,j as S}from"./entry-client-70f5ea60.js";import"./index-608f9ce4.js";import"./EventWrapper-00d7d2f9.js";import"./index-c5d10f7a.js";import"./open-library-64fefcf2.js";const Y=()=>{const{relay:f,anchorsMode:d}=R(V),[p,l]=e(!1),[w,i]=e(!1),[t,h]=U();let o;const[T,u]=e([]),[O,m]=e([]),[I,g]=e([]),[s,n]=e([]),[r,E]=e([]),[A,P]=e(0),[_,y]=e(!1),C=async()=>await x(f,l,T,u,O,m,I,g,s,n,r,E,d.get,i,{fetchEventsLimit:15,maxEventsCount:75,searchParams:t});X(async()=>{(t.following==null||t.following=="undefined")&&h({...t,following:"on"}),(t.relayAddress==null||t.relayAddress=="undefined")&&h({...t,relayAddress:"all"}),o=await C()}),B(async()=>{d.get(),clearInterval(o),u([]),n([]),E([]),m([]),g([]),i(!1),o=await C()}),H(()=>{clearInterval(o)});const N=()=>{const a=s().length+r().length,c=[...s(),...r()].sort(k);a>75?n(c.slice(a-75,a).sort(S)):n([...s(),...r()].sort(S)),E([])},M=async()=>{l(!0);const a=s().length,c=await F(f,{fetchEventsLimit:20,maxEventsCount:75,searchParams:t},d.get,s,n);y(c.olderEventsCount==0),c.olderEventsCount&&P(a),l(!1)};return v(j,{get when(){return!p()},get fallback(){return v(b,{})},get children(){return v(L,{enrichedEvents:s,mergeEnrichedEvents:N,showPopup:w,setShowPopup:i,loadOlderPosts:M,mostRecentOlderEventIndex:A,isFeedOver:_})}})};export{Y as default};
