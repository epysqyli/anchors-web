import{F as y,f as L,a as R}from"./feed-6c35ba5d.js";import{T as V,u as U,R as X,e as b,b as e,o as B,d as H,f as k,c as i,l as j,G as g,U as D,S as G,h as q,j as T}from"./entry-client-70f5ea60.js";import"./index-608f9ce4.js";import"./EventWrapper-00d7d2f9.js";import"./index-c5d10f7a.js";import"./open-library-64fefcf2.js";const ee=()=>{const p=V(),{relay:v,anchorsMode:c}=U(X);let a;const[C]=b(),[S,h]=e([]),[I,E]=e(!1),[O,d]=e(!1),[w,u]=e([]),[N,m]=e([]),[t,s]=e([]),[o,l]=e([]),[_,M]=e(0),[P,A]=e(!1),f=async()=>await L(v,d,S,h,w,u,N,m,t,s,o,l,c.get,E,{fetchEventsLimit:33,maxEventsCount:75,nostrHashTag:p.tag});B(async()=>{a=await f()}),H(async()=>{c.get(),clearInterval(a),h([]),s([]),l([]),u([]),m([]),E(!1),a=await f()});const F=()=>{const n=t().length+o().length,r=[...t(),...o()].sort(q);n>75?s(r.slice(n-75,n).sort(T)):s([...t(),...o()].sort(T)),l([])},x=async()=>{d(!0);const n=t().length,r=await R(v,{fetchEventsLimit:5,maxEventsCount:75,searchParams:C},c.get,t,s);A(r.olderEventsCount==0),r.olderEventsCount&&M(n),d(!1)};return k(()=>{clearInterval(a)}),i(G,{get when(){return j(()=>!O()&&g()!==void 0)()&&!g()},get fallback(){return i(D,{})},get children(){return i(y,{enrichedEvents:t,showPopup:I,setShowPopup:E,mergeEnrichedEvents:F,isFeedOver:P,loadOlderPosts:x,mostRecentOlderEventIndex:_})}})};export{ee as default};
