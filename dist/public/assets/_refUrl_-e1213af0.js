import{u as F,R as x,T as y,e as L,b as e,o as U,d as V,f as X,c as i,U as b,S as B,h as k,j as p}from"./entry-client-70f5ea60.js";import{F as H,f as j,a as D}from"./feed-6c35ba5d.js";import"./index-608f9ce4.js";import"./EventWrapper-00d7d2f9.js";import"./index-c5d10f7a.js";import"./open-library-64fefcf2.js";const Z=()=>{const{relay:v,anchorsMode:c}=F(x),C=y();let a;const[T]=L(),[g,h]=e([]),[S,E]=e(!1),[O,l]=e(!1),[I,f]=e([]),[w,u]=e([]),[t,s]=e([]),[o,d]=e([]),[_,N]=e(!1),[M,P]=e(0),m=async()=>await j(v,l,g,h,I,f,w,u,t,s,o,d,c.get,E,{fetchEventsLimit:33,maxEventsCount:75,nostrRefTag:C.refUrl});U(async()=>{a=await m()}),V(async()=>{c.get(),clearInterval(a),h([]),s([]),d([]),f([]),u([]),E(!1),a=await m()});const R=()=>{const n=t().length+o().length,r=[...t(),...o()].sort(k);n>75?s(r.slice(n-75,n).sort(p)):s([...t(),...o()].sort(p)),d([])},A=async()=>{l(!0);const n=t().length,r=await D(v,{fetchEventsLimit:5,maxEventsCount:75,searchParams:T},c.get,t,s);N(r.olderEventsCount==0),r.olderEventsCount&&P(n),l(!1)};return X(()=>{clearInterval(a)}),i(B,{get when(){return!O()},get fallback(){return i(b,{})},get children(){return i(H,{enrichedEvents:t,showPopup:S,setShowPopup:E,mergeEnrichedEvents:R,isFeedOver:_,loadOlderPosts:A,mostRecentOlderEventIndex:M})}})};export{Z as default};
