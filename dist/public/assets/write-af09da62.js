import{k as V,g as h,a as A,i as r,l as oe,n as k,q as ae,c as s,B as ie,r as N,t as _,v as ce,b as y,w as de,x as Y,y as ue,V as ee,z as ge,C as fe,D as he,G as Q,H as re,I as ve,J as xe,F as U,M as te,S as j,K as L,u as se,R as pe,N as me,e as be,O as $e,o as ye,d as _e,Q as we,P as Se}from"./entry-client-70f5ea60.js";import{R as Te,s as Re,a as ke,b as Ce}from"./open-library-64fefcf2.js";import{T as Ee}from"./index-c5d10f7a.js";const Ie=_('<div class="flex justify-between py-2 px-2 my-2 group border-orange-400 border-opacity-40 border-b mx-2 gap-x-5 transition cursor-pointer active:scale-95 active:bg-slate-500 hover:border-opacity-100"><div class="w-1/5"></div><div class="text-right w-4/5"><div class="text-sm md:text-base text-slate-100"></div><div class="text-xs md:text-sm text-slate-400 mt-2"></div><div class="text-xs md:text-sm text-slate-400 mt-2"></div></div><!#><!/>'),ze=_('<img loading="lazy">'),Be=_('<div class="bg-slate-500 h-full rounded">'),Ae=n=>{const c=()=>n.result;return(()=>{const v=h(Ie),i=v.firstChild,d=i.nextSibling,o=d.firstChild,f=o.nextSibling,a=f.nextSibling,$=d.nextSibling,[E,p]=A($.nextSibling);return v.$$click=()=>n.addTag(c()),r(i,(()=>{const C=oe(()=>c().preview!="");return()=>C()?(()=>{const m=h(ze);return k(()=>ae(m,"src",c().preview)),m})():h(Be)})()),r(o,()=>c().title),r(f,()=>c().additionalInfoOne),r(a,()=>c().additionalInfoTwo),r(v,s(ie,{size:22,class:"text-slate-200 group-hover:scale-125 group-active:scale-100 transition"}),E,p),N(),v})()};V(["click"]);const Le=_('<div class="flex items-center px-2 justify-between bg-slate-700 text-slate-100 border-x border-orange-300"><div class="p-3 rounded-xl"></div><div class="text break-all w-2/3 px-3 py-6"><div></div><div class="text-slate-400 text-sm"></div></div><div class="p-3 rounded-xl cursor-pointer hover:scale-105 transition hover:text-red-300 active:scale-90">'),Ne=n=>(()=>{const c=h(Le),v=c.firstChild,i=v.nextSibling,d=i.firstChild,o=d.nextSibling,f=i.nextSibling;return r(v,s(Te,{get category(){return n.tag.category}})),r(d,()=>n.tag.title!=""?n.tag.title:n.tag.url),r(o,()=>n.tag.additionalInfoOne),f.$$click=()=>n.removeReferenceTag(n.tag),r(f,s(ce,{size:28,class:"mx-auto","stroke-width":1})),N(),c})();V(["click"]);const G=_('<div class="animate-pulse w-5/6 mx-auto bg-slate-500 bg-opacity-30 h-1/5 rounded mb-5">'),Oe=_('<div class="h-[80dvh] max-h-[80dvh] xl:h-[80%] xl:max-h-[80%]"><div class="flex items-center justify-between gap-x-1 md:px-5 md:gap-x-10 text-slate-200 h-[15%]"><div><div class="group-active:scale-95 transition w-fit mx-auto absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"><!#><!/><div class="absolute -top-5 -right-10"></div></div></div><div><div class="group-active:scale-95 transition w-fit mx-auto absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div></div><div class="w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded md:hidden active:bg-slate-700"><div class="group-active:scale-95 transition absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div></div></div><div class="py-5 overflow-auto xl:custom-scrollbar h-[82%] my-3 mr-2"><!#><!/><!#><!/>'),Me=_('<div class="h-[19dvh] xl:h-[20%] w-11/12 mx-auto md:w-full py-1 px-2"><div class="flex items-center gap-x-3 px-5 justify-around h-3/5"></div><form class="flex items-center justify-center gap-x-1 h-2/5 mt-1 mx-auto md:px-5 md:gap-x-5"><input type="text" class="block focus:outline-none py-2 caret-slate-200 placeholder:text-center placeholder:text text-slate-200 text-center focus:placeholder-none h-full w-4/5 bg-slate-600 border-y border-transparent focus:border-orange-200"><button class="block group text-slate-50 hover:bg-slate-600 active:bg-slate-800 p-3 h-full rounded w-1/5">'),Pe=_('<div><div class="w-fit absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 group-active:scale-90">'),De=n=>{const[c,v]=y([{icon:s(de,{size:30}),selected:!1,category:"book",placeholder:"search for books on openlibrary",searchButton:s(Y,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(ue,{size:30}),selected:!1,category:"video",placeholder:"add a video url to this post",searchButton:s(ee,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(ge,{size:30}),selected:!1,category:"movie",placeholder:"search for a movie on TMDB",searchButton:s(Y,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(fe,{size:30}),selected:!1,category:"song",placeholder:"search for a song on spotify",searchButton:s(Y,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(he,{size:30}),selected:!0,category:"generic",placeholder:"add a generic url to this post",searchButton:s(ee,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})}]),[i,d]=y(c()[4]),[o,f]=y(!1),[a,$]=y(""),[E,p]=y([]),[C,m]=y(!1),I=async l=>{switch(l.preventDefault(),p([]),m(!0),i().category){case"book":p(await Ce(a()));break;case"song":p(await ke(a()));break;case"movie":p(await Re(a()));break}m(!1)},W=l=>{const t=c().map(e=>({icon:e.icon,selected:e.selected,category:e.category,placeholder:e.placeholder,searchButton:e.searchButton})).map(e=>(e.selected=e.category==l,e.selected&&d(e),e));v(t)},O=l=>{if(l.preventDefault(),a().trim()==""){console.log("visual hint: input is empty");return}if(i().category=="generic"||i().category=="video"){const x={category:i().category,title:a(),url:a(),preview:"",additionalInfoOne:"",additionalInfoTwo:""};n.addReferenceTag(x);return}f(!0),I(l)},K=l=>{$(l.currentTarget.value)},q=l=>{const x=`cursor-pointer group transition-scale
                        h-3/5 w-1/5 relative border-y border-transparent
                        hover:border-slate-400 text-slate-300`,t=x+" bg-slate-600 border-orange-200 ";return l?t:x},M=l=>l?"w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded bg-slate-600":"w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded hover:bg-slate-700";return[(()=>{const l=h(Oe),x=l.firstChild,t=x.firstChild,e=t.firstChild,u=e.firstChild,[g,w]=A(u.nextSibling),S=g.nextSibling,b=t.nextSibling,H=b.firstChild,z=b.nextSibling,J=z.firstChild,B=x.nextSibling,P=B.firstChild,[R,D]=A(P.nextSibling),F=R.nextSibling,[ne,le]=A(F.nextSibling);return t.$$click=()=>f(!1),r(e,s(re,{get size(){return Q()?30:40}}),g,w),r(S,()=>n.tags.length),b.$$click=()=>f(!0),r(H,s(Ee,{get size(){return Q()?30:40}})),ve(z,"click",n.toggleBetweenWriteAndRefs,!0),r(J,s(xe,{get size(){return Q()?30:40}})),r(B,s(j,{get when(){return!o()},get children(){return s(U,{get each(){return n.tags},children:T=>s(te.div,{animate:{scale:[.5,1]},class:"mb-3 w-11/12 mx-auto",get children(){return s(Ne,{tag:T,get removeReferenceTag(){return n.removeReferenceTag}})}})})}}),R,D),r(B,s(j,{get when(){return o()},get children(){return[s(j,{get when(){return C()},get children(){return[h(G),h(G),h(G),h(G)]}}),s(j,{get when(){return!C()},get children(){return s(U,{get each(){return E()},children:T=>s(te.div,{animate:{scale:[.5,1]},class:"mb-3 w-11/12 mx-auto",get children(){return s(Ae,{result:T,get addTag(){return n.addReferenceTag}})}})})}})]}}),ne,le),k(T=>{const X=M(!o()),Z=M(o());return X!==T._v$&&L(t,T._v$=X),Z!==T._v$2&&L(b,T._v$2=Z),T},{_v$:void 0,_v$2:void 0}),N(),l})(),(()=>{const l=h(Me),x=l.firstChild,t=x.nextSibling,e=t.firstChild,u=e.nextSibling;return r(x,s(U,{get each(){return c()},children:g=>(()=>{const w=h(Pe),S=w.firstChild;return w.$$click=()=>W(g.category),r(S,()=>g.icon),k(()=>L(w,q(g.selected))),N(),w})()})),t.addEventListener("submit",O),e.addEventListener("change",K),r(u,()=>i().searchButton),k(()=>ae(e,"placeholder",i().placeholder)),k(()=>e.value=a()),l})()]};V(["click"]);const Fe=_('<div class="grid grid-cols-1 xl:grid-cols-7 gap-x-2 h-[100dvh] xl:h-full mx-auto"><div><h1 class="text-slate-100 text-center text-2xl md:text-4xl font-bold">Write a new idea</h1><textarea placeholder="Time to connect the dots" class="block w-4/5 2xl:w-2/3 placeholder:text-center placeholder:text-lg text-lg focus:outline-none bg-transparent mx-auto text-slate-300 caret-orange-200 resize-none xl:custom-scrollbar px-5 py-2" rows="14"></textarea><div class="flex items-center justify-around xl:block"><div class="text-orange-300 mx-auto py-12 group cursor-pointer hover:bg-slate-600 rounded-md w-4/5"></div><div class="xl:hidden relative text-slate-300 mx-auto py-12 group cursor-pointer hover:bg-slate-600 rounded-md w-4/5"><!#><!/><span class="absolute top-7 right-16"></span></div></div></div><div>'),je=_('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full">'),Ge=_('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 xl:w-1/3">'),qe=()=>{const{relay:n}=se(pe),c=se(me),v="current-nostr-post-content",i="current-nostr-post-reftags",[d]=be(),[o,f]=y([],{equals:!1}),[a,$]=y({content:"",created_at:Math.floor(Date.now()/1e3),kind:$e.Text,tags:[]},{equals:!1}),[E,p]=y(""),[C,m]=y(!1),[I,W]=y(!1),O=()=>{c.toggleMenuButton(),W(!I())},K=t=>{const e=t.currentTarget.value;$({...a(),content:e})},q=()=>window.nostr==null?(m(!0),p("A browser nostr extension is needed to sign events, but is currently not available"),!1):a().content.trim().length==0?(p("There is no content, write something first"),m(!0),!1):a().tags.filter(t=>t[0]=="r").length==0?(m(!0),p("There are no references for this post: this idea must have originated somewhere though!"),!1):!0,M=t=>{$({...a(),tags:[...a().tags,["r",t.url]]}),f([...o(),t])},l=t=>{const e=a().tags.findIndex(b=>b[1]===t.url),u=a().tags;u.splice(e,1);const g=a();g.tags=u,$(g);const w=o().findIndex(b=>b.url==t.url),S=o();S.splice(w,1),f(S)},x=async()=>{if(!q())return;const t=a();t.tags=[...a().tags,["r",n.ANCHORS_EVENT_RTAG_IDENTIFIER]],$(t);const e=await window.nostr.signEvent(a()),u=n.pub(e);u.on("ok",()=>{m(!0),p("Post correctly published! Find it in your 'my posts' section"),localStorage.removeItem(v),localStorage.removeItem(i)}),u.on("failed",()=>{m(!0),p("Something did not work when publishing the post, please try again.")})};return ye(()=>{const t=localStorage.getItem(v);t!="undefined"&&t!=null&&$({...a(),content:t});const e=JSON.parse(localStorage.getItem(i));e?.flat()&&(f([...o(),...e]),$({...a(),tags:[...a().tags,...e.map(u=>["r",u.url])]})),d.url&&(o().find(g=>g.url==d.url)||(f([...o(),{title:d.primaryInfo,category:d.category,url:d.url,preview:d.preview,additionalInfoOne:"",additionalInfoTwo:""}]),$({...a(),tags:[...a().tags,["r",d.url]]})))}),_e(()=>{localStorage.setItem(v,a().content),localStorage.setItem(i,JSON.stringify(o()))}),[(()=>{const t=h(Fe),e=t.firstChild,u=e.firstChild,g=u.nextSibling,w=g.nextSibling,S=w.firstChild,b=S.nextSibling,H=b.firstChild,[z,J]=A(H.nextSibling),B=z.nextSibling,P=e.nextSibling;return g.$$input=K,S.$$click=x,r(S,s(we,{size:40,class:"w-fit mx-auto group-hover:scale-110 group-active:scale-90 transition"})),b.$$click=O,r(b,s(re,{size:40,class:"w-fit mx-auto group-hover:scale-110 group-active:scale-90 transition"}),z,J),r(B,()=>o().length),r(P,s(De,{get tags(){return o()},addReferenceTag:M,removeReferenceTag:l,toggleBetweenWriteAndRefs:O})),k(R=>{const D=`${I()?"hidden":""} flex flex-col justify-between py-10 xl:col-span-4 
                                                       rounded-md bg-slate-600 bg-opacity-10`,F=`${I()?"":"hidden"} xl:block xl:col-span-3 rounded-md bg-slate-800 
                                                       bg-opacity-80 h-full xl:py-4 overflow-y-auto 2xl:px-10`;return D!==R._v$&&L(e,R._v$=D),F!==R._v$2&&L(P,R._v$2=F),R},{_v$:void 0,_v$2:void 0}),k(()=>g.value=a().content),N(),t})(),(()=>{const t=h(Ge);return r(t,s(Se,{autoClose:!0,show:C,setShow:m,get children(){const e=h(je);return r(e,E),e}})),t})()]};V(["input","click"]);export{qe as default};
