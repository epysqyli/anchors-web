import{u as D,R as I,b as c,o as q,g as a,c as n,U as K,a as O,i,l as w,$ as T,n as u,q as J,S as Y,a0 as j,P as B,t as l,O as G}from"./entry-client-70f5ea60.js";import{a as H}from"./index-608f9ce4.js";const Q=l('<h1 class="text-slate-100 text-center text-2xl md:text-4xl font-bold py-5 xl:py-10">Update your profile info'),V=l('<form class="mx-auto w-11/12 xl:w-2/5"><div class="py-3 px-5 mb-10"><label class="text-slate-200 text-lg select-none text-center block mb-3 p-2 rounded bg-slate-600 w-1/3">name</label><input type="text" name="name" placeholder="enter your nostr name to show to other users" class="p-3 rounded text-center text-lg text-slate-200 caret-slate-200 bg-neutral-600 focus:outline-none w-full"></div><div class="py-3 px-5 mb-10"><label class="text-slate-200 text-lg select-none text-center block mb-3 p-2 rounded bg-slate-600 w-1/3">about</label><input type="text" name="about" placeholder="something about yourself" class="p-3 rounded text-center text-lg text-slate-200 caret-slate-200 bg-neutral-600 focus:outline-none w-full"></div><div class="py-3 px-5"><div class="flex items-center mb-3 gap-x-3"><label class="text-slate-200 text-lg select-none text-center block p-2 rounded bg-slate-600 w-1/3">picture</label><img loading="lazy" class="h-10 rounded-full"></div><input type="text" name="picture" placeholder="url pointing to an avatar image" class="p-3 rounded text-center text-lg text-slate-200 caret-slate-200 bg-neutral-600 focus:outline-none w-full"></div><!#><!/>'),W=l('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full">'),X=l('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 xl:w-1/3">'),Z=l('<button class="block w-fit px-10 mt-16 mx-auto py-5 rounded-md bg-slate-600 group">'),ee=l("<p>Nostr profile metadata successfully updated!"),te=l("<p>Request failed"),ne=()=>{const{relay:d,authMode:S}=D(I),[s,b]=c({name:"",about:"",picture:""}),p=e=>{const t=e.currentTarget;b({...s(),[t.name]:t.value})},C=async e=>{e.preventDefault();const t={content:JSON.stringify(s()),created_at:Math.floor(Date.now()/1e3),kind:G.Metadata,tags:[]},o=await window.nostr.signEvent(t),r=d.pub(o);r.on("ok",()=>{g(!0),x(!0)}),r.on("failed",()=>{g(!1),x(!0)})},[k,x]=c(!1),[E,g]=c(!1),[ae,M]=c(!1),[L,R]=c(!0);return q(async()=>{if(d.userPubKey==""){console.log("Your public key is not available"),g(!1);return}const e=await d.fetchUserMetadata();e&&b(e),R(!1)}),[a(Q),n(Y,{get when(){return!L()},get fallback(){return n(K,{})},get children(){const e=a(V),t=e.firstChild,o=t.firstChild,r=o.nextSibling,m=t.nextSibling,z=m.firstChild,f=z.nextSibling,h=m.nextSibling,v=h.firstChild,F=v.firstChild,_=F.nextSibling,$=v.nextSibling,P=h.nextSibling,[N,U]=O(P.nextSibling);return e.addEventListener("submit",C),r.addEventListener("change",p),f.addEventListener("change",p),_.addEventListener("error",()=>M(!0)),$.addEventListener("change",p),i(e,(()=>{const A=w(()=>S.get()=="private");return()=>A()?(()=>{const y=a(Z);return i(y,n(T,{class:"text-slate-100 mx-auto group-hover:scale-110 group-active:scale-90 transition-transform",size:38})),y})():[]})(),N,U),u(()=>J(_,"src",s().picture??"")),u(()=>r.value=s().name??""),u(()=>f.value=s().about??""),u(()=>$.value=s().picture??""),e}}),(()=>{const e=a(X);return i(e,n(B,{autoClose:!0,show:k,setShow:x,get children(){const t=a(W);return i(t,(()=>{const o=w(()=>!!E());return()=>o()?[a(ee),n(j,{class:"mx-auto mt-8",size:44})]:[a(te),n(H,{class:"mx-auto mt-8",size:44})]})()),t}})),e})()]};export{ne as default};
