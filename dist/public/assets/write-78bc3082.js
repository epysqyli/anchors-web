import{k as W,g as d,a as N,i as a,l as X,n as k,q as ne,c as s,B as ce,r as M,t as m,v as de,b as w,w as ue,x as Q,y as ge,V as te,z as fe,C as he,D as ve,G as E,H as le,I as xe,J as pe,F as U,M as se,S as z,K as O,u as re,R as me,N as be,e as $e,O as _e,o as we,d as ye,Q as Se,P as ae}from"./entry-client-aec7b634.js";import{R as Te,s as Re,a as Ce,b as ke}from"./open-library-7291d1eb.js";import{T as Ee}from"./index-419528e1.js";const Ie=m('<div class="flex justify-between py-2 px-2 my-2 group border-orange-400 border-opacity-40 border-b mx-2 gap-x-5 transition cursor-pointer active:scale-95 active:bg-slate-500 hover:border-opacity-100"><div class="w-1/5"></div><div class="text-right w-4/5"><div class="text-sm md:text-base text-slate-100"></div><div class="text-xs md:text-sm text-slate-400 mt-2"></div><div class="text-xs md:text-sm text-slate-400 mt-2"></div></div><!#><!/>'),ze=m('<img loading="lazy">'),Be=m('<div class="bg-slate-500 h-full rounded">'),Ae=n=>{const u=()=>n.result;return(()=>{const v=d(Ie),c=v.firstChild,g=c.nextSibling,o=g.firstChild,h=o.nextSibling,r=h.nextSibling,_=g.nextSibling,[I,b]=N(_.nextSibling);return v.$$click=()=>n.addTag(u()),a(c,(()=>{const C=X(()=>u().preview!="");return()=>C()?(()=>{const x=d(ze);return k(()=>ne(x,"src",u().preview)),x})():d(Be)})()),a(o,()=>u().title),a(h,()=>u().additionalInfoOne),a(r,()=>u().additionalInfoTwo),a(v,s(ce,{size:22,class:"text-slate-200 group-hover:scale-125 group-active:scale-100 transition"}),I,b),M(),v})()};W(["click"]);const Le=m('<div class="flex items-center px-2 justify-between bg-slate-700 text-slate-100 border-x border-orange-300"><div class="p-3 rounded-xl"></div><div class="text break-all w-2/3 px-3 py-6"><div></div><div class="text-slate-400 text-sm"></div></div><div class="p-3 rounded-xl cursor-pointer hover:scale-105 transition hover:text-red-300 active:scale-90">'),Ne=n=>(()=>{const u=d(Le),v=u.firstChild,c=v.nextSibling,g=c.firstChild,o=g.nextSibling,h=c.nextSibling;return a(v,s(Te,{get category(){return n.tag.category}})),a(g,()=>n.tag.title!=""?n.tag.title:n.tag.url),a(o,()=>n.tag.additionalInfoOne),h.$$click=()=>n.removeReferenceTag(n.tag),a(h,s(de,{size:28,class:"mx-auto","stroke-width":1})),M(),u})();W(["click"]);const V=m('<div class="animate-pulse w-5/6 mx-auto bg-slate-500 bg-opacity-30 h-1/5 rounded mb-5">'),Oe=m('<div class="h-[80dvh] max-h-[80dvh] xl:h-[80%] xl:max-h-[80%]"><div class="flex items-center justify-between gap-x-1 md:px-5 md:gap-x-10 text-slate-200 h-[15%]"><div><div class="group-active:scale-95 transition w-fit mx-auto absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"><!#><!/><div class="absolute -top-5 -right-10"></div></div></div><div><div class="group-active:scale-95 transition w-fit mx-auto absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div></div><div class="w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded md:hidden active:bg-slate-700"><div class="group-active:scale-95 transition absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div></div></div><div class="py-5 overflow-auto xl:custom-scrollbar h-[82%] my-3 mr-2"><!#><!/><!#><!/>'),Me=m('<div class="h-[19dvh] xl:h-[20%] w-11/12 mx-auto md:w-full py-1 px-2"><div class="flex items-center gap-x-3 px-5 justify-around h-3/5"></div><form class="flex items-center justify-center gap-x-1 h-2/5 mt-1 mx-auto md:px-5 md:gap-x-5"><input type="text" class="block focus:outline-none py-2 caret-slate-200 placeholder:text-center placeholder:text text-slate-200 text-center focus:placeholder-none h-full w-4/5 bg-slate-600 border-y border-transparent focus:border-orange-200"><button class="block group text-slate-50 hover:bg-slate-600 active:bg-slate-800 p-3 h-full rounded w-1/5">'),Pe=m('<div><div class="w-fit absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 group-active:scale-90">'),De=n=>{const[u,v]=w([{icon:s(ue,{size:30}),selected:!1,category:"book",placeholder:"search for books on openlibrary",searchButton:s(Q,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(ge,{size:30}),selected:!1,category:"video",placeholder:"add a video url to this post",searchButton:s(te,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(fe,{size:30}),selected:!1,category:"movie",placeholder:"search for a movie on TMDB",searchButton:s(Q,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(he,{size:30}),selected:!1,category:"song",placeholder:"search for a song on spotify",searchButton:s(Q,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})},{icon:s(ve,{size:30}),selected:!0,category:"generic",placeholder:"add a generic url to this post",searchButton:s(te,{size:32,class:"group-hover:scale-90 w-fit mx-auto"})}]),[c,g]=w(u()[4]),[o,h]=w(!1),[r,_]=w(""),[I,b]=w([]),[C,x]=w(!1),B=async l=>{switch(l.preventDefault(),b([]),x(!0),c().category){case"book":b(await ke(r()));break;case"song":b(await Ce(r()));break;case"movie":b(await Re(r()));break}x(!1)},K=l=>{const t=u().map(e=>({icon:e.icon,selected:e.selected,category:e.category,placeholder:e.placeholder,searchButton:e.searchButton})).map(e=>(e.selected=e.category==l,e.selected&&g(e),e));v(t)},P=l=>{if(l.preventDefault(),r().trim()==""){console.log("visual hint: input is empty");return}if(c().category=="generic"||c().category=="video"){const p={category:c().category,title:r(),url:r(),preview:"",additionalInfoOne:"",additionalInfoTwo:""};n.addReferenceTag(p);return}h(!0),B(l)},q=l=>{_(l.currentTarget.value)},H=l=>{const p=`cursor-pointer group transition-scale
                        h-3/5 w-1/5 relative border-y border-transparent
                        hover:border-slate-400 text-slate-300`,t=p+" bg-slate-600 border-orange-200 ";return l?t:p},D=l=>l?"w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded bg-slate-600":"w-1/2 relative h-full text-center group cursor-pointer transition xl:rounded hover:bg-slate-700";return[(()=>{const l=d(Oe),p=l.firstChild,t=p.firstChild,e=t.firstChild,i=e.firstChild,[f,y]=N(i.nextSibling),S=f.nextSibling,$=t.nextSibling,J=$.firstChild,A=$.nextSibling,Y=A.firstChild,L=p.nextSibling,F=L.firstChild,[R,j]=N(F.nextSibling),G=R.nextSibling,[oe,ie]=N(G.nextSibling);return t.$$click=()=>h(!1),a(e,s(le,{get size(){return E()?30:40}}),f,y),a(S,()=>n.tags.length),$.$$click=()=>h(!0),a(J,s(Ee,{get size(){return E()?30:40}})),xe(A,"click",n.toggleBetweenWriteAndRefs,!0),a(Y,s(pe,{get size(){return E()?30:40}})),a(L,s(z,{get when(){return!o()},get children(){return s(U,{get each(){return n.tags},children:T=>s(se.div,{animate:{scale:[.5,1]},class:"mb-3 w-11/12 mx-auto",get children(){return s(Ne,{tag:T,get removeReferenceTag(){return n.removeReferenceTag}})}})})}}),R,j),a(L,s(z,{get when(){return o()},get children(){return[s(z,{get when(){return C()},get children(){return[d(V),d(V),d(V),d(V)]}}),s(z,{get when(){return!C()},get children(){return s(U,{get each(){return I()},children:T=>s(se.div,{animate:{scale:[.5,1]},class:"mb-3 w-11/12 mx-auto",get children(){return s(Ae,{result:T,get addTag(){return n.addReferenceTag}})}})})}})]}}),oe,ie),k(T=>{const Z=D(!o()),ee=D(o());return Z!==T._v$&&O(t,T._v$=Z),ee!==T._v$2&&O($,T._v$2=ee),T},{_v$:void 0,_v$2:void 0}),M(),l})(),(()=>{const l=d(Me),p=l.firstChild,t=p.nextSibling,e=t.firstChild,i=e.nextSibling;return a(p,s(U,{get each(){return u()},children:f=>(()=>{const y=d(Pe),S=y.firstChild;return y.$$click=()=>K(f.category),a(S,()=>f.icon),k(()=>O(y,H(f.selected))),M(),y})()})),t.addEventListener("submit",P),e.addEventListener("change",q),a(i,()=>c().searchButton),k(()=>ne(e,"placeholder",c().placeholder)),k(()=>e.value=r()),l})()]};W(["click"]);const Fe=m('<div class="grid grid-cols-1 xl:grid-cols-7 gap-x-2 h-[100dvh] xl:h-full mx-auto"><div><h1 class="text-slate-100 text-center text-2xl md:text-4xl font-bold">Write a new idea</h1><textarea placeholder="Time to connect the dots" class="block w-4/5 2xl:w-2/3 placeholder:text-center placeholder:text-lg text-lg focus:outline-none bg-transparent mx-auto text-slate-300 caret-orange-200 resize-none xl:custom-scrollbar px-5 py-2" rows="14"></textarea><div class="flex items-center justify-around xl:block"><div class="text-orange-300 mx-auto py-12 group cursor-pointer hover:bg-slate-600 rounded-md w-4/5"></div><div class="xl:hidden relative text-slate-300 mx-auto py-12 group cursor-pointer hover:bg-slate-600 rounded-md w-4/5"><!#><!/><span class="absolute top-7 right-16"></span></div></div></div><div>'),je=m('<div class="h-screen w-screen pt-20 bg-slate-800 bg-opacity-95"><div class="w-4/5 mx-auto">'),Ge=m('<div class="absolute top-0 left-0 z-10">'),Ve=m('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full">'),We=m('<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 xl:w-1/3">'),Je=()=>{const{relay:n}=re(me),u=re(be),v="current-nostr-post-content",c="current-nostr-post-reftags",[g]=$e(),[o,h]=w([],{equals:!1}),[r,_]=w({content:"",created_at:Math.floor(Date.now()/1e3),kind:_e.Text,tags:[]},{equals:!1}),[I,b]=w(""),[C,x]=w(!1),[B,K]=w(!1),P=()=>{u.toggleMenuButton(),K(!B())},q=t=>{const e=t.currentTarget.value;_({...r(),content:e})},H=()=>window.nostr==null?(x(!0),b("A browser nostr extension is needed to sign events, but is currently not available"),!1):r().content.trim().length==0?(b("There is no content, write something first"),x(!0),!1):r().tags.filter(t=>t[0]=="r").length==0?(x(!0),b("There are no references for this post: this idea must have originated somewhere though!"),!1):!0,D=t=>{_({...r(),tags:[...r().tags,["r",t.url]]}),h([...o(),t])},l=t=>{const e=r().tags.findIndex($=>$[1]===t.url),i=r().tags;i.splice(e,1);const f=r();f.tags=i,_(f);const y=o().findIndex($=>$.url==t.url),S=o();S.splice(y,1),h(S)},p=async()=>{if(!H())return;const t=r();t.tags=[...r().tags,["r",n.ANCHORS_EVENT_RTAG_IDENTIFIER]],_(t);const e=await window.nostr.signEvent(r()),i=n.pub(e);i.on("ok",()=>{x(!0),b("Post correctly published! Find it in your 'my posts' section"),localStorage.removeItem(v),localStorage.removeItem(c)}),i.on("failed",()=>{x(!0),b("Something did not work when publishing the post, please try again.")})};return we(()=>{const t=localStorage.getItem(v);t!="undefined"&&t!=null&&_({...r(),content:t});const e=JSON.parse(localStorage.getItem(c));e?.flat()&&(h([...o(),...e]),_({...r(),tags:[...r().tags,...e.map(i=>["r",i.url])]})),g.url&&(o().find(f=>f.url==g.url)||(h([...o(),{title:g.primaryInfo,category:g.category,url:g.url,preview:g.preview,additionalInfoOne:"",additionalInfoTwo:""}]),_({...r(),tags:[...r().tags,["r",g.url]]})))}),ye(()=>{localStorage.setItem(v,r().content),localStorage.setItem(c,JSON.stringify(o()))}),[(()=>{const t=d(Fe),e=t.firstChild,i=e.firstChild,f=i.nextSibling,y=f.nextSibling,S=y.firstChild,$=S.nextSibling,J=$.firstChild,[A,Y]=N(J.nextSibling),L=A.nextSibling,F=e.nextSibling;return f.$$input=q,S.$$click=p,a(S,s(Se,{size:40,class:"w-fit mx-auto group-hover:scale-110 group-active:scale-90 transition"})),$.$$click=P,a($,s(le,{size:40,class:"w-fit mx-auto group-hover:scale-110 group-active:scale-90 transition"}),A,Y),a(L,()=>o().length),a(F,s(De,{get tags(){return o()},addReferenceTag:D,removeReferenceTag:l,toggleBetweenWriteAndRefs:P})),k(R=>{const j=`${B()?"hidden":""} flex flex-col justify-between py-10 xl:col-span-4 
                                                       rounded-md bg-slate-600 bg-opacity-10`,G=`${B()?"":"hidden"} xl:block xl:col-span-3 rounded-md bg-slate-800 
                                                       bg-opacity-80 h-full xl:py-4 overflow-y-auto 2xl:px-10`;return j!==R._v$&&O(e,R._v$=j),G!==R._v$2&&O(F,R._v$2=G),R},{_v$:void 0,_v$2:void 0}),k(()=>f.value=r().content),M(),t})(),s(z,{get when(){return X(()=>E()!=null)()&&E()},get children(){const t=d(Ge);return a(t,s(ae,{autoClose:!1,show:C,setShow:x,get children(){const e=d(je),i=e.firstChild;return a(i,I),e}})),t}}),s(z,{get when(){return X(()=>E()!=null)()&&!E()},get children(){const t=d(We);return a(t,s(ae,{autoClose:!0,show:C,setShow:x,get children(){const e=d(Ve);return a(e,I),e}})),t}})]};W(["input","click"]);export{Je as default};
